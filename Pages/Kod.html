<!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="JavaScript demos och kodexempel av Anton Ahlm, webbutvecklare och designer." />
    <meta name="keywords" content="JavaScript kod, web development, webbutveckling, web design, webbdesign, web portfolio, javascript, web manager">
    <meta name="author" content="Anton Ahlm">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Portfolio — Code &amp; Functions</title>
    <link rel="icon" type="image/x-icon" href="./Styles/Anton-favicon.png">
    <link rel="stylesheet" href="../Styles/Portfolio.css" />
    <style>
      input::placeholder,
      textarea::placeholder {
        color: #000;
        opacity: 1;
      }
    </style>
  </head>
  <body style="padding-bottom: 80px;">

    <!-- Site Header -->
    <header>
      <div class="nav" role="navigation" aria-label="Top navigation">
        <div class="brand">
          <div class="logo"><code>&lt;Anton<br/>Ahlm&gt;</code></div>
          <div>
            <div style="font-weight: 700">Portfolio</div>
            <div style="font-size: 12px; color: var(--muted)">Web designer &amp; developer</div>
          </div>
        </div>

        <!-- Primary Navigation -->
        <nav>
          <ul id="mobile-menu">
            <li><a class="btn" href="../home.html">Hem</a></li>
            <li><a class="btn" href="./mittCV.html">CV</a></li>
            <li><a class="btn" href="../home.html#contact">Kontakt</a></li>
          </ul>
        </nav>

        <button class="menu-toggle btn" aria-expanded="false" aria-controls="mobile-menu">Meny ☰</button>
      </div>
    </header>

    <main  id="top">
      <!-- Hero & Intro -->
      <div class="container hero kod-hero" id="heroImage">
        <h1>JavaScript Kod</h1>

        <script>
          // Typing effect to introduce the code playground
          (function () {
            const message = 'Välkommen att utforska mina interaktiva demos, kodade i JavaScript. Skrolla ner och testa programmen!';
            const container = document.createElement('div');
            container.id = 'typing';
            container.style.fontFamily = 'monospace';
            container.style.margin = '0.5rem 0 1rem';
            container.style.whiteSpace = 'pre-wrap';
            container.style.fontSize = '1.2em';
            container.style.textAlign = 'center';

            const headings = Array.from(document.querySelectorAll('h1'));
            const targetHeading = headings.find((heading) => heading.textContent.includes('JavaScript'));
            if (targetHeading && targetHeading.parentNode) {
              targetHeading.parentNode.insertBefore(container, targetHeading.nextSibling);
            } else {
              document.body.appendChild(container);
            }

            let index = 0;
            function step() {
              container.textContent = message.slice(0, index++);
              if (index <= message.length) {
                window.setTimeout(step, 30);
              }
            }
            step();
          })();
        </script>

        <div>
          <a href="#start"  id="start" class="back-to-top" aria-label="Back to top" style="color: white; display: inline-block; cursor: pointer; text-decoration: none; position: relative; z-index: 1000; pointer-events: auto;">
            <svg xmlns="http://www.w3.org/2000/svg" width="62" height="62" viewBox="0 0 32 32" fill="none" style="pointer-events: auto; display: block;">
              <path d="M10 10 L16 16 L22 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M10 16 L16 22 L22 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </a>
        </div>
      </div>

      <!-- Code Demos -->
      <div class="container">

        <div class="Koder">
          <h2>Vem betalar?</h2>
          <script>
            // Randomly selects a name from the provided list
            (function () {
              const notaContainer = document.createElement('div');
              notaContainer.id = 'nota';
              notaContainer.style.fontFamily = 'monospace';
              notaContainer.style.margin = '0.5rem 0 1rem';
              notaContainer.style.whiteSpace = 'pre-wrap';
              notaContainer.style.fontSize = '1.2em';

              const headings = Array.from(document.querySelectorAll('h2'));
              const targetHeading = headings.find((heading) => heading.textContent.includes('Vem betalar?'));
              if (targetHeading && targetHeading.parentNode) {
                targetHeading.parentNode.insertBefore(notaContainer, targetHeading.nextSibling);
              } else {
                document.body.appendChild(notaContainer);
              }

              const form = document.createElement('div');
              form.style.display = 'flex';
              form.style.gap = '0.5rem';
              form.style.alignItems = 'center';
              form.style.margin = '0.5rem 0';

              const input = document.createElement('input');
              input.type = 'text';
              input.id = 'namesInput';
              input.placeholder = 'Ange namn, separera med kommatecken';
              input.style.flex = '1';
              input.style.padding = '0.4rem';
              input.style.fontSize = '1rem';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Vem betalar?';
              button.style.padding = '0.4rem 0.6rem';
              button.style.fontSize = '1rem';
              button.style.cursor = 'pointer';

              form.appendChild(input);
              form.appendChild(button);
              notaContainer.parentNode.insertBefore(form, notaContainer.nextSibling);

              function whosPaying(names) {
                if (!Array.isArray(names)) {
                  names = [names];
                }
                if (names.length === 0) {
                  return null;
                }
                const randomIndex = Math.floor(Math.random() * names.length);
                return names[randomIndex];
              }

              function parseNames(raw) {
                if (!raw) {
                  return [];
                }
                return raw.split(/[,;\n]+/).map((name) => name.trim()).filter(Boolean);
              }

              function showResult(text) {
                notaContainer.textContent = text;
              }

              function pickAndShow() {
                const names = parseNames(input.value);
                if (names.length === 0) {
                  showResult('Skriv in minst ett namn (separera med kommatecken).');
                  return;
                }
                const winner = whosPaying(names);
                showResult(`${winner} ska bjuda på lunch idag!`);
              }

              button.addEventListener('click', pickAndShow);
              input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                  event.preventDefault();
                  pickAndShow();
                }
              });

              input.value = 'Anna, Björn, Cecilia';
            })();
          </script>
        </div>

        <div class="Koder">
          <h2>Antal tecken skrivna</h2>
          <script>
            // Counts characters and provides a preview of the typed message
            (function () {
              const MAX = 140;
              const scriptElement = document.currentScript;

              const container = document.createElement('div');
              container.style.margin = '0.5rem 0 1rem';
              container.style.fontFamily = 'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial';

              const label = document.createElement('label');
              label.htmlFor = 'weatherInput';
              label.textContent = 'Skriv din text (max 140 tecken):';
              label.style.display = 'block';
              label.style.marginBottom = '0.3rem';

              const textarea = document.createElement('textarea');
              textarea.id = 'weatherInput';
              textarea.rows = 4;
              textarea.maxLength = MAX;
              textarea.placeholder = 'Skriv här...';
              textarea.style.width = '100%';
              textarea.style.padding = '0.4rem';
              textarea.style.boxSizing = 'border-box';
              textarea.style.fontSize = '1rem';
              textarea.style.fontFamily = 'monospace';
              textarea.style.marginBottom = '0.4rem';

              const controls = document.createElement('div');
              controls.style.display = 'flex';
              controls.style.alignItems = 'center';
              controls.style.gap = '0.5rem';
              controls.style.marginBottom = '0.5rem';
              controls.style.color = '#fff';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Visa förhandsgranskning';
              button.style.padding = '0.4rem 0.6rem';
              button.style.cursor = 'pointer';

              const counter = document.createElement('div');
              counter.style.fontSize = '0.95rem';
              counter.style.color = '#fff';
              counter.style.whiteSpace = 'nowrap';
              counter.textContent = `0 / ${MAX}`;

              controls.appendChild(button);
              controls.appendChild(counter);

              const previewLabel = document.createElement('div');
              previewLabel.textContent = 'Förhandsgranskning:';
              previewLabel.style.margin = '0.4rem 0 0.2rem';
              previewLabel.style.fontWeight = '600';

              const preview = document.createElement('pre');
              preview.style.background = '#f7f7f7';
              preview.style.padding = '0.6rem';
              preview.style.whiteSpace = 'pre-wrap';
              preview.style.borderRadius = '4px';
              preview.style.minHeight = '3rem';
              preview.style.margin = '0';
              preview.style.color = '#000';

              container.appendChild(label);
              container.appendChild(textarea);
              container.appendChild(controls);
              container.appendChild(previewLabel);
              container.appendChild(preview);

              if (scriptElement && scriptElement.parentNode) {
                scriptElement.parentNode.insertBefore(container, scriptElement.nextSibling);
              } else {
                document.body.appendChild(container);
              }

              function updateCounter() {
                const length = textarea.value.length;
                counter.textContent = `${length} / ${MAX} (${MAX - length} kvar)`;
              }

              function updatePreview() {
                const text = textarea.value.slice(0, MAX);
                const chars = text.length;
                preview.textContent = `${text}\n\nDu har skrivit ${chars} tecken och har ${MAX - chars} tecken kvar tills max antal av ${MAX}.`;
              }

              textarea.addEventListener('input', updateCounter);
              button.addEventListener('click', updatePreview);

              updateCounter();
            })();
          </script>
        </div>

        <div class="Koder">
          <h2>Hundår</h2>
          <script>
            // Converts dog years into the human-year equivalent
            (function () {
              const scriptElement = document.currentScript;
              const container = document.createElement('div');
              container.style.margin = '0.5rem 0 1rem';
              container.style.fontFamily = 'system-ui, -apple-system, "Segoe UI", Roboto, Arial';

              const label = document.createElement('label');
              label.textContent = 'Ange din hunds ålder (år):';
              label.style.display = 'block';
              label.style.marginBottom = '0.3rem';
              label.style.color = '#fff';

              const controls = document.createElement('div');
              controls.style.display = 'flex';
              controls.style.alignItems = 'center';
              controls.style.gap = '0.5rem';

              const input = document.createElement('input');
              input.type = 'number';
              input.min = '0';
              input.step = '0.1';
              input.placeholder = 'e.g. 3.5';
              input.style.padding = '0.4rem';
              input.style.fontSize = '1rem';
              input.style.width = '8rem';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Räkna ut';
              button.style.padding = '0.4rem 0.6rem';
              button.style.cursor = 'pointer';

              const result = document.createElement('div');
              result.style.marginTop = '0.5rem';
              result.style.fontWeight = '600';

              controls.appendChild(input);
              controls.appendChild(button);
              container.appendChild(label);
              container.appendChild(controls);
              container.appendChild(result);

              if (scriptElement && scriptElement.parentNode) {
                scriptElement.parentNode.insertBefore(container, scriptElement.nextSibling);
              } else {
                document.body.appendChild(container);
              }

              function calcHumanYears(dogAgeRaw) {
                const age = Number(dogAgeRaw);
                if (!Number.isFinite(age)) {
                  result.textContent = 'Var god ange ett giltigt nummer.';
                  return;
                }
                if (age < 0) {
                  result.textContent = 'Åldern kan inte vara negativ.';
                  return;
                }
                const human = Math.round(((age - 2) * 4) + 21);
                result.textContent = `Din ${age} år gamla hund är ${human} år gammal i hundår.`;
              }

              button.addEventListener('click', () => calcHumanYears(input.value));
              input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                  event.preventDefault();
                  calcHumanYears(input.value);
                }
              });
            })();
          </script>
        </div>

        <div class="Koder">
          <h2>Gästlista</h2>
          <p>(Gästerna som är bjudna är: Maja, Anton, Josefin, Janne, Barbro, Lilly, Lava, Marie, Mats, Signe, Alvin.)</p>
          <script>
            // Case-insensitive lookup against a predefined guest list
            (function () {
              const guestList = ['Maja', 'Anton', 'Josefin', 'Janne', 'Barbro', 'Lilly', 'Lava', 'Marie', 'Mats', 'Signe', 'Alvin'];
              const scriptElement = document.currentScript;

              const container = document.createElement('div');
              container.style.margin = '0.5rem 0 1rem';
              container.style.fontFamily = 'system-ui, -apple-system, "Segoe UI", Roboto, Arial';

              const form = document.createElement('div');
              form.style.display = 'flex';
              form.style.gap = '0.5rem';
              form.style.alignItems = 'center';

              const input = document.createElement('input');
              input.type = 'text';
              input.placeholder = 'Skriv ditt namn här';
              input.style.flex = '1';
              input.style.padding = '0.4rem';
              input.style.fontSize = '1rem';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Kolla gästlista';
              button.style.padding = '0.4rem 0.6rem';
              button.style.cursor = 'pointer';

              form.appendChild(input);
              form.appendChild(button);

              const result = document.createElement('div');
              result.style.marginTop = '0.4rem';
              result.style.fontWeight = '600';

              container.appendChild(form);
              container.appendChild(result);

              if (scriptElement && scriptElement.parentNode) {
                scriptElement.parentNode.insertBefore(container, scriptElement.nextSibling);
              } else {
                document.body.appendChild(container);
              }

              function checkName() {
                const name = input.value.trim();
                if (!name) {
                  result.textContent = 'Skriv in ett namn.';
                  return;
                }
                const match = guestList.find((guest) => guest.toLowerCase() === name.toLowerCase());
                if (match) {
                  result.textContent = `Välkommen till festen, ${match}!`;
                } else {
                  result.textContent = `${name} är inte på gästlistan.`;
                }
              }

              button.addEventListener('click', checkName);
              input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                  event.preventDefault();
                  checkName();
                }
              });
            })();
          </script>
        </div>

        <div class="Koder">
          <h2>Skottår</h2>
          <script>
            // Validates whether a given year is a leap year
            (function () {
              const scriptElement = document.currentScript;

              function isLeap(year) {
                const value = Number(year);
                if (!Number.isFinite(value) || !Number.isInteger(value) || value < 0) {
                  return null;
                }
                if (value % 4 !== 0) {
                  return false;
                }
                if (value % 100 !== 0) {
                  return true;
                }
                if (value % 400 !== 0) {
                  return false;
                }
                return true;
              }

              const container = document.createElement('div');
              container.style.margin = '0.5rem 0 1rem';
              container.style.fontFamily = 'system-ui, -apple-system, "Segoe UI", Roboto, Arial';

              const label = document.createElement('label');
              label.textContent = 'Ange ett år för att se om det är ett skottår:';
              label.style.display = 'block';
              label.style.marginBottom = '0.3rem';

              const controls = document.createElement('div');
              controls.style.display = 'flex';
              controls.style.gap = '0.5rem';
              controls.style.alignItems = 'center';

              const input = document.createElement('input');
              input.type = 'number';
              input.min = '0';
              input.step = '1';
              input.placeholder = 't.ex. 2024';
              input.style.padding = '0.4rem';
              input.style.fontSize = '1rem';
              input.style.width = '8rem';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Kontrollera';
              button.style.padding = '0.4rem 0.6rem';
              button.style.cursor = 'pointer';

              const result = document.createElement('div');
              result.style.marginTop = '0.5rem';
              result.style.fontWeight = '600';

              controls.appendChild(input);
              controls.appendChild(button);
              container.appendChild(label);
              container.appendChild(controls);
              container.appendChild(result);

              if (scriptElement && scriptElement.parentNode) {
                scriptElement.parentNode.insertBefore(container, scriptElement.nextSibling);
              } else {
                document.body.appendChild(container);
              }

              function showResultForYear(value) {
                const year = Number(value);
                if (!Number.isFinite(year) || !Number.isInteger(year)) {
                  result.textContent = 'Var god ange ett giltigt heltal för året.';
                  return;
                }
                const leap = isLeap(year);
                if (leap === null) {
                  result.textContent = 'Ogiltigt år.';
                } else if (leap) {
                  result.textContent = `År ${year} är ett skottår.`;
                } else {
                  result.textContent = `År ${year} är inte ett skottår.`;
                }
              }

              button.addEventListener('click', () => showResultForYear(input.value));
              input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                  event.preventDefault();
                  showResultForYear(input.value);
                }
              });

              input.value = new Date().getFullYear();
            })();
          </script>
        </div>

        <div class="Koder">
          <h2>Love-tester</h2>
          <script>
            // Generates playful compatibility and fight chance scores
            (function () {
              const scriptElement = document.currentScript;

              const container = document.createElement('div');
              container.style.margin = '0.5rem 0 1rem';
              container.style.fontFamily = 'system-ui, -apple-system, "Segoe UI", Roboto, Arial';

              const form = document.createElement('div');
              form.style.display = 'flex';
              form.style.flexWrap = 'wrap';
              form.style.gap = '0.5rem';
              form.style.alignItems = 'center';

              const input1 = document.createElement('input');
              input1.type = 'text';
              input1.placeholder = 'Namn på person 1';
              input1.style.flex = '1';
              input1.style.minWidth = '10rem';
              input1.style.padding = '0.4rem';
              input1.style.fontSize = '1rem';

              const input2 = document.createElement('input');
              input2.type = 'text';
              input2.placeholder = 'Namn på person 2';
              input2.style.flex = '1';
              input2.style.minWidth = '10rem';
              input2.style.padding = '0.4rem';
              input2.style.fontSize = '1rem';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Kontrollera kärlekskompabilitet';
              button.style.padding = '0.4rem 0.6rem';
              button.style.cursor = 'pointer';

              form.appendChild(input1);
              form.appendChild(input2);
              form.appendChild(button);

              const result = document.createElement('pre');
              result.style.marginTop = '0.5rem';
              result.style.fontWeight = '600';
              result.style.whiteSpace = 'pre-wrap';
              result.style.background = '#000';
              result.style.padding = '0.6rem';
              result.style.borderRadius = '4px';
              result.style.minHeight = '2.2rem';
              result.style.margin = '0.5rem 0 0';

              container.appendChild(form);
              container.appendChild(result);

              if (scriptElement && scriptElement.parentNode) {
                scriptElement.parentNode.insertBefore(container, scriptElement.nextSibling);
              } else {
                document.body.appendChild(container);
              }

              function compute() {
                const name1 = input1.value.trim() || 'Person A';
                const name2 = input2.value.trim() || 'Person B';
                const loveChance = Math.floor(Math.random() * 100) + 1;
                let message;
                if (loveChance === 100) {
                  message = `${name1} + ${name2} = en perfekt match på 100%!`;
                } else if (loveChance > 70) {
                  message = `${name1} + ${name2} = en fantastisk match på ${loveChance}%.`;
                } else if (loveChance > 30) {
                  message = `${name1} + ${name2} = en dålig match på bara ${loveChance}%...`;
                } else {
                  message = `${name1} + ${name2} = en usel match på bara ${loveChance}%...`;
                }
                const fightChance = Math.floor(Math.random() * 100) + 1;
                message += `\n...och det är ${fightChance}% chans att ${name2} vinner i ett slagsmål.`;
                result.textContent = message;
              }

              button.addEventListener('click', compute);
              [input1, input2].forEach((input) => {
                input.addEventListener('keydown', (event) => {
                  if (event.key === 'Enter') {
                    event.preventDefault();
                    compute();
                  }
                });
              });

              input1.value = 'Anton';
              input2.value = 'Antons fru';
            })();
          </script>
        </div>

        <div class="Koder">
          <h2>Hur länge har du kvar att leva?</h2>
          <script>
            // Calculates remaining time until a target age based on the input age
            (function () {
              const scriptElement = document.currentScript;
              const container = document.createElement('div');
              container.style.margin = '0.5rem 0 1rem';
              container.style.fontFamily = 'system-ui, -apple-system, "Segoe UI", Roboto, Arial';

              const label = document.createElement('label');
              label.textContent = 'Ange din ålder i år:';
              label.style.display = 'block';
              label.style.marginBottom = '0.3rem';

              const controls = document.createElement('div');
              controls.style.display = 'flex';
              controls.style.gap = '0.5rem';
              controls.style.alignItems = 'center';

              const input = document.createElement('input');
              input.type = 'number';
              input.min = '0';
              input.step = '0.1';
              input.placeholder = 't.ex. 29.5';
              input.style.padding = '0.4rem';
              input.style.fontSize = '1rem';
              input.style.width = '8rem';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Beräkna';
              button.style.padding = '0.4rem 0.6rem';
              button.style.cursor = 'pointer';

              const result = document.createElement('div');
              result.style.marginTop = '0.5rem';
              result.style.fontWeight = '600';

              controls.appendChild(input);
              controls.appendChild(button);
              container.appendChild(label);
              container.appendChild(controls);
              container.appendChild(result);

              if (scriptElement && scriptElement.parentNode) {
                scriptElement.parentNode.insertBefore(container, scriptElement.nextSibling);
              } else {
                document.body.appendChild(container);
              }

              function lifeInWeeks(age, deathYear = 90) {
                const value = Number(age);
                if (!Number.isFinite(value) || value < 0) {
                  result.textContent = 'Var god ange en giltig ålder (nummer >= 0).';
                  return;
                }
                if (value >= deathYear) {
                  result.textContent = `Du är redan ${value} år eller äldre — målet (${deathYear} år) är uppnått.`;
                  return;
                }
                const days = Math.round((deathYear - value) * 365);
                const weeks = Math.round((deathYear - value) * 52);
                const months = Math.round((deathYear - value) * 12);
                result.textContent = `Du har ungefär ${days} dagar, ${weeks} veckor och ${months} månader kvar tills du blir ${deathYear} år.`;
              }

              button.addEventListener('click', () => lifeInWeeks(input.value));
              input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                  event.preventDefault();
                  lifeInWeeks(input.value);
                }
              });

              input.value = '29';
            })();
          </script>
        </div>

        <div class="Koder">
          <h2>FizzBuzz</h2>
          <script>
            // Displays divisibility results for numbers up to the chosen limit
            (function () {
              const scriptElement = document.currentScript;

              const container = document.createElement('div');
              container.style.margin = '0.5rem 0 1rem';
              container.style.fontFamily = 'system-ui, -apple-system, "Segoe UI", Roboto, Arial';

              const label = document.createElement('label');
              label.textContent = 'FizzBuzz (kontrollera delbarhet med 2, 3 och 5). Ange högsta tal:';
              label.style.display = 'block';
              label.style.marginBottom = '0.3rem';

              const controls = document.createElement('div');
              controls.style.display = 'flex';
              controls.style.gap = '0.5rem';
              controls.style.alignItems = 'center';
              controls.style.marginBottom = '0.5rem';

              const input = document.createElement('input');
              input.type = 'number';
              input.min = '1';
              input.max = '10000';
              input.value = '10';
              input.style.padding = '0.4rem';
              input.style.fontSize = '1rem';
              input.style.width = '8rem';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Kör FizzBuzz';
              button.style.padding = '0.4rem 0.6rem';
              button.style.cursor = 'pointer';

              controls.appendChild(input);
              controls.appendChild(button);

              const outputInfo = document.createElement('div');
              outputInfo.style.margin = '0.25rem 0';
              outputInfo.style.fontSize = '0.95rem';
              outputInfo.style.color = '#fff';

              const result = document.createElement('div');
              result.style.marginTop = '0.5rem';
              result.style.padding = '0.5rem';
              result.style.background = '#fff';
              result.style.borderRadius = '6px';
              result.style.maxHeight = '320px';
              result.style.overflow = 'auto';
              result.style.fontFamily = 'monospace';
              result.style.whiteSpace = 'pre-wrap';

              container.appendChild(label);
              container.appendChild(controls);
              container.appendChild(outputInfo);
              container.appendChild(result);

              if (scriptElement && scriptElement.parentNode) {
                scriptElement.parentNode.insertBefore(container, scriptElement.nextSibling);
              } else {
                document.body.appendChild(container);
              }

              function joinWithOch(arr) {
                if (arr.length === 0) {
                  return '';
                }
                if (arr.length === 1) {
                  return String(arr[0]);
                }
                if (arr.length === 2) {
                  return `${arr[0]} och ${arr[1]}`;
                }
                return `${arr.slice(0, -1).join(', ')} och ${arr[arr.length - 1]}`;
              }

              function runFizzBuzz() {
                result.innerHTML = '';
                outputInfo.textContent = '';
                const n = Number(input.value);
                if (!Number.isFinite(n) || !Number.isInteger(n) || n < 1) {
                  outputInfo.textContent = 'Ange ett giltigt heltal >= 1.';
                  return;
                }
                if (n > 5000) {
                  outputInfo.textContent = 'Varning: stort värde kan göra sidan långsam. Begränsa under 5000.';
                }

                const list = document.createElement('ul');
                list.style.listStyle = 'none';
                list.style.padding = '0';
                list.style.margin = '0';

                for (let i = 1; i <= n; i++) {
                  const divisors = [];
                  if (i % 2 === 0) {
                    divisors.push(2);
                  }
                  if (i % 3 === 0) {
                    divisors.push(3);
                  }
                  if (i % 5 === 0) {
                    divisors.push(5);
                  }

                  const item = document.createElement('li');
                  item.style.padding = '0.15rem 0';
                  if (divisors.length === 3) {
                    item.style.color = '#6a0dad';
                  } else if (divisors.length === 2) {
                    item.style.color = '#d2691e';
                  } else if (divisors.length === 1) {
                    item.style.color = '#007700';
                  } else {
                    item.style.color = '#000';
                  }

                  if (divisors.length === 0) {
                    item.textContent = String(i);
                  } else {
                    item.textContent = `${i} är delbart med ${joinWithOch(divisors)}.`;
                  }
                  list.appendChild(item);
                }

                result.appendChild(list);
                outputInfo.textContent = `Visar resultat för 1 → ${n}.`;
                result.scrollTop = 0;
              }

              button.addEventListener('click', runFizzBuzz);
              input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                  event.preventDefault();
                  runFizzBuzz();
                }
              });

              runFizzBuzz();
            })();
          </script>
        </div>

        <div class="Koder">
          <h2>Fibonacci-sekvenser</h2>
          <script>
            // Builds and shows the requested number of Fibonacci sequence values
            (function () {
              const scriptElement = document.currentScript;

              function fibonacciGenerator(n) {
                const count = Number(n);
                if (!Number.isFinite(count) || !Number.isInteger(count) || count < 0) {
                  return null;
                }
                const fib = [];
                for (let i = 0; i < count; i++) {
                  if (i === 0) {
                    fib.push(0);
                  } else if (i === 1) {
                    fib.push(1);
                  } else {
                    fib.push(fib[i - 1] + fib[i - 2]);
                  }
                }
                return fib;
              }

              const container = document.createElement('div');
              container.style.margin = '0.5rem 0 1rem';
              container.style.fontFamily = 'system-ui, -apple-system, "Segoe UI", Roboto, Arial';

              const label = document.createElement('label');
              label.textContent = 'Generera Fibonacci-sekvens (antal tal):';
              label.style.display = 'block';
              label.style.marginBottom = '0.3rem';

              const controls = document.createElement('div');
              controls.style.display = 'flex';
              controls.style.gap = '0.5rem';
              controls.style.alignItems = 'center';

              const input = document.createElement('input');
              input.type = 'number';
              input.min = '0';
              input.max = '500';
              input.value = '10';
              input.style.width = '6rem';
              input.style.padding = '0.4rem';
              input.style.fontSize = '1rem';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Generera';
              button.style.padding = '0.4rem 0.6rem';
              button.style.cursor = 'pointer';

              const info = document.createElement('div');
              info.style.marginTop = '0.4rem';
              info.style.fontSize = '0.95rem';
              info.style.color = '#333';

              const output = document.createElement('pre');
              output.style.marginTop = '0.5rem';
              output.style.whiteSpace = 'pre-wrap';
              output.style.background = '#000';
              output.style.padding = '0.6rem';
              output.style.borderRadius = '4px';
              output.style.fontFamily = 'monospace';

              container.appendChild(label);
              container.appendChild(controls);
              container.appendChild(info);
              container.appendChild(output);
              controls.appendChild(input);
              controls.appendChild(button);

              if (scriptElement && scriptElement.parentNode) {
                scriptElement.parentNode.insertBefore(container, scriptElement.nextSibling);
              } else {
                document.body.appendChild(container);
              }

              function render(n) {
                output.textContent = '';
                info.textContent = '';
                const num = Number(n);
                if (!Number.isFinite(num) || !Number.isInteger(num) || num < 0) {
                  info.textContent = 'Ange ett giltigt heltal >= 0.';
                  return;
                }
                if (num > 200) {
                  info.textContent = 'Stort antal; visning kan bli långsam.';
                }
                const sequence = fibonacciGenerator(num) || [];
                output.textContent = sequence.length === 0 ? '(Inga tal)' : sequence.join(', ');
                if (sequence.length > 0) {
                  const lines = sequence.map((value, index) => `${index + 1}: ${value}`).join('\n');
                  output.textContent = `${output.textContent}\n\nIndex:värde\n${lines}`;
                }
              }

              button.addEventListener('click', () => render(input.value));
              input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                  event.preventDefault();
                  render(input.value);
                }
              });

              render(input.value);
            })();
          </script>
        </div>

        <div class="Koder">
          <h2>X bottles of beers on the wall..</h2>
          <script>
            // Generates the "X bottles of beer" lyrics with sensible limits
            (function () {
              const scriptElement = document.currentScript;

              const container = document.createElement('div');
              container.style.margin = '0.5rem 0 1rem';
              container.style.fontFamily = 'system-ui, -apple-system, "Segoe UI", Roboto, Arial';

              const label = document.createElement('label');
              label.textContent = 'Ange antal flaskor öl som heltal (rekommenderar max 10):';
              label.style.display = 'block';
              label.style.marginBottom = '0.3rem';

              const controls = document.createElement('div');
              controls.style.display = 'flex';
              controls.style.gap = '0.5rem';
              controls.style.alignItems = 'center';

              const input = document.createElement('input');
              input.type = 'number';
              input.min = '0';
              input.max = '100';
              input.value = '3';
              input.style.width = '8rem';
              input.style.padding = '0.4rem';
              input.style.fontSize = '1rem';

              const button = document.createElement('button');
              button.type = 'button';
              button.textContent = 'Visa sången';
              button.style.padding = '0.4rem 0.6rem';
              button.style.cursor = 'pointer';

              const info = document.createElement('div');
              info.style.marginTop = '0.4rem';
              info.style.fontSize = '0.95rem';
              info.style.color = '#333';

              const output = document.createElement('pre');
              output.style.marginTop = '0.5rem';
              output.style.whiteSpace = 'pre-wrap';
              output.style.background = '#000';
              output.style.padding = '0.6rem';
              output.style.borderRadius = '4px';
              output.style.fontFamily = 'monospace';
              output.style.maxHeight = '320px';
              output.style.overflow = 'auto';
              output.style.color = '#fff';

              controls.appendChild(input);
              controls.appendChild(button);
              container.appendChild(label);
              container.appendChild(controls);
              container.appendChild(info);
              container.appendChild(output);

              if (scriptElement && scriptElement.parentNode) {
                scriptElement.parentNode.insertBefore(container, scriptElement.nextSibling);
              } else {
                document.body.appendChild(container);
              }

              function stanzaLines(n) {
                if (n > 2) {
                  return [
                    `${n} bottles of beer on the wall, ${n} bottles of beer.`,
                    `Take one down and pass it around, ${n - 1} ${n - 1 === 1 ? 'bottle' : 'bottles'} of beer on the wall.`,
                  ];
                }
                if (n === 2) {
                  return [
                    '2 bottles of beer on the wall, 2 bottles of beer.',
                    'Take one down and pass it around, 1 bottle of beer on the wall.',
                  ];
                }
                if (n === 1) {
                  return [
                    '1 bottle of beer on the wall, 1 bottle of beer.',
                    'Take one down and pass it around, no more bottles of beer on the wall.',
                  ];
                }
                return [
                  'No more bottles of beer on the wall, no more bottles of beer.',
                  'Go to the store and buy some more, 99 bottles of beer on the wall.',
                ];
              }

              function generateSong(raw) {
                const value = Number(raw);
                if (!Number.isFinite(value) || !Number.isInteger(value) || value < 0) {
                  info.textContent = 'Ange ett giltigt heltal >= 0.';
                  return '';
                }
                if (value > 300) {
                  info.textContent = 'Stort antal — visar upp till 300 för prestanda.';
                } else {
                  info.textContent = '';
                }
                const cap = Math.min(value, 300);
                const parts = [];
                for (let i = cap; i >= 0; i--) {
                  parts.push(...stanzaLines(i));
                  if (i !== 0) {
                    parts.push('');
                  }
                }
                if (value > cap) {
                  parts.push('', `...truncated (${value - cap} stanzas borttagnade för prestanda).`);
                }
                return parts.join('\n');
              }

              function showSong() {
                output.textContent = generateSong(input.value);
                output.scrollTop = 0;
              }

              button.addEventListener('click', showSong);
              input.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                  event.preventDefault();
                  showSong();
                }
              });

              showSong();
            })();
          </script>
        </div>

      </div>
        <div style="display: flex; justify-content: center; align-items: center; margin: 0 auto;">
          <a href="#top" class="back-to-top" aria-label="Back to top" style="color: white; display: inline-block; cursor: pointer; text-decoration: none; position: relative; z-index: 1000; pointer-events: auto;">
            <svg xmlns="http://www.w3.org/2000/svg" width="62" height="62" viewBox="0 0 32 32" fill="none" style="pointer-events: auto; display: block; rotate: 180deg;">
              <path d="M10 10 L16 16 L22 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M10 16 L16 22 L22 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </a>
        </div>

    </main>
      <!-- Site Footer -->
  <footer>
    © <span id="year"></span> Anton Ahlm — Web designer & developer
  </footer>

    <!-- Page Enhancements -->
    <script>
      // Handles the mobile navigation toggle and smooth scrolling
      (function () {
        const menuToggle = document.querySelector('.menu-toggle');
        if (menuToggle) {
          menuToggle.addEventListener('click', () => {
            const controlledId = menuToggle.getAttribute('aria-controls');
            let navMenu = null;
            if (controlledId) {
              navMenu = document.getElementById(controlledId);
            }
            if (!navMenu) {
              navMenu = document.querySelector('nav ul');
            }
            if (!navMenu) {
              return;
            }

            const expanded = menuToggle.getAttribute('aria-expanded') === 'true';
            menuToggle.setAttribute('aria-expanded', String(!expanded));
            navMenu.classList.toggle('show-mobile');
          });
        }

        document.querySelectorAll('a[href^="#"]').forEach((link) => {
          link.addEventListener('click', (event) => {
            const href = link.getAttribute('href');
            if (!href || href === '#') {
              return;
            }

            const target = document.querySelector(href);
            if (target) {
              event.preventDefault();
              target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          });
        });
      })();
    </script>
  </body>
  </html>
